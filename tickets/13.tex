\section{Топологическая сортировка. Алгоритм Косарайю поиска сильносвязанных компонент.}
\noindent{\bf Топологическая сортировка:}\\
Дано: Ориентированный ациклический граф $G = (V, E)$.\\
Надо: Пронумеровать вершины $V$ графа так, чтобы для любого ребра $(u, v) \in E$ номер вершины $v$ был больше номера вершины $u$.\\
(Другими словами: расположить вершины на временной оси так, чтобы все ребра были направлены "в будущее".)\\
Решение: Выводим вершины в обратном post-порядке.\\
Через $A(v),\ v\in V$ обозначим множество таких вершин $u\in V$, что $\exists\  (u,v)\in E$.
То есть, $A(v)$ - множество всех вершин, из которых есть ребро в вершину $v$. Пусть $P$ -
искомая последовательность вершин.\\
Псевдокод:
\begin{verbatim}
while |P|<|V|:
    выбрать любую вершину v такую, что A(v) 
                пусто, и v не принадлежит P
    P.append (v)
    удалить v из всех A(u), где u != v
end
\end{verbatim}
\note{Пример работы алгоритма есть в Википедии:\\
https://ru.wikipedia.org/wiki/Топологическая\_сортировка}\\

На компьютере топологическую сортировку можно выполнить за $O(n)$ времени и памяти,
если обойти все вершины, используя DFN, и выводить вершины в момент выхода из неё.\\
Другими словами, алгоритм (Тарьяна) состоит в следующем:
\begin{itemize}
\item Изначально все вершины белые.
\item Для каждой вершины делаем шаг алгоритма.
\end{itemize}
Шаг алгоритма:
\begin{itemize}
\item Если вершина чёрная, ничего делать не надо.
\item Если вершина серая - найден цикл, топологическая сортировка невозможна.
\item Если вершина белая
\begin{itemize}
\item Красим её в серый
\item Применяем шаг алгоритма для всех вершин, в которые можно попасть из текущей
\item Красим вершину в чёрный и помещаем её в начало окончательного списка.
\end{itemize}
\end{itemize}

\noindent{\bf Алгоритм Косарайю:}\\
Ориентированный граф называется {\bf сильно связным (strongly connected)}, если любые две его вершины $s$ и $t$ сильно связны, т.е. если существует ориентированный путь из $s$ в $t$ и ориентированный путь из $t$ в $s$. Компонентами сильной связности орграфа называются его максимальные по включению сильно связные подграфы.\\
{\bf Компонента-сток} - (простыми словами) компонента, в которую можно только войти, но нельзя из нее выйти.\\
{\it Утв 1.} Пусть $v$ лежит в компоненте-стоке. Тогда DFS($G$, $v$) обойдет все вершины в компоненте и только их.\\
{\it Утв 2.} Пусть $C$ и $C'$ - компоненты сильной связности, и существует ребро из $C$ в $C'$. Тогда
$$
\max\limits_{c\in C} post(c) > \max\limits_{c'\in C'} post(c')
$$
{\it Следствие.} Вершина с максимальным post-значением лежит в компоненте-истоке.\\

\noindentАлгоритм Косарайю:
\begin{enumerate}
\item Инвертируем ребра (меняем их направление) исходного ориентированного графа - получаем обращённый граф.
\item Запускаем DFS на этом обращённом графе, запоминая, в каком порядке выходили из вершин.
\item Запускаем DFS на исходном графе, в очередной раз выбирая не посещённую вершину с максимальным номером в векторе, полученном в п.2.
\item Полученные из п.3 деревья и являются сильно связными компонентами (Каждое множество вершин, достигнутое в результате очередного запуска обхода, и будет очередной компонентой сильной связности.)
\end{enumerate}
Подробное и понятное описание алгоритма по ссылке:\\
https://e-maxx.ru/algo/strong\_connected\_components\\
Сложность: $O(n)$. 
